## DOM이란??

자바스크립트 렌더링 엔진은 HTML 문서를 이해하기 위해 DOM이라는 자료구조를 생성한다.

그리고 HTML 요소는 중첩 관계를 갖는다. 예를 들어 body 태그 안에 p태그도 있을 수 있고, input 태그도 있을 수 있는데 이 요소들의 부자 관계를 반영하여 모든 노드들을 트리 자료구조로 구성한다.

이렇게 완성된 트리 자료구조를 우리는 DOM이라고 부른다.

DOM API를 수많은 플랫폼과 웹 브라우저에서 사용하고 있지만 치명적인 단점이 존재한다.

HTML이 정적 페이지이기 때문에 동적인 UI를 처리하는데 최적화되어 있지 않다는 것이다. 자바스크립트를 이용하여 웹 페이지를 동적으로 만들수는 있기는 하다.

하지만 브라우저의 렌더링 과정을 공부했을 때 DOM을 계속 조작하는 것이 성능에 좋지 않다는 것을 배웠었다.

> Javascript에서 css나 html 코드를 조작하면 변경된 DOM과 CSSOM을 기반으로 HTML 요소의 레이아웃을 계산하고 페인팅해야 하는데 이 과정에서 시간을 많이 잡아먹는다.

그래서 리액트는 DOM 대신에 Virtual DOM을 만들어 DOM 처리횟수를 최소화하였고 더 효율적인 프로그래밍이 가능해졌다.

이제 Virtual DOM은 무엇이고 어떻게 동작하는지에 대해 알아보자.

## Virtual DOM

> Virtual DOM은 원래의 DOM 노드 트리를 복제한 자바스크립트 객체이다.

자바스크립트에서는 `document.querySelector('~~').textContent = "minhye`라고 입력한다면 DOM 조작이 바로 가능하다.

하지만 리액트는 이렇게 바로 DOM에 조작하지 않고 가상의 DOM을 만드는 방식을 사용하고 있다.

우리가 리액트에서 코드를 작성할 때 이런 코드를 쓰곤한다.

```javascript
import ReactDOM from "react-dom/client";
```

이렇게 ReactDOM을 동기화하여 우리가 작성하는 파일에 가져오는 것이다.

## Virtual DOM의 동작 방식

> "Virtual DOM은 UI의 이상적인 또는 가상적인 표현을 메모리에 저장하고 ReactDOM과 같은 라이브러리에 의해 실제 DOM과 동기화하는 프로그래밍 개념입니다" - 리액트 공식문서

최초에 브라우저가 실제 DOM 트리를 생성하고 브라우저 화면에 UI를 렌더링한다.

이 때 DOM 트리를 가상 DOM으로 복사하여 DOM의 가벼운 버전을 만든다.

그리고 나서 데이터의 변화가 생기면 변화를 반영한 새로운 가상 DOM 트리를 생성한다.

이전에 만들어두었던 가상 DOM 트리와 새롭게 만들어진 가상 DOM 트리를 비교하여 변화가 있는 부분만 실제 DOM에 적용한다.

변경 사항이 있을 때마다 DOM을 조작하지 않고 Virtual DOM에서 모든 변화들을 반영한 후에 한 번만 렌더링 되므로 성능이 더 좋아질 수 있다.

## 재조정

초기 렌더링된 DOM과 상태가 변화하여 업데이트 될 DOM을 비교하고 둘의 차이를 알아내어 실제 DOM에 적용한다고 했다.

이러한 과정 자체를 재조정(reconciliation)이라고 하는 것이다.

가상 돔에 계속 업데이트를 하고 새로운 DOM을 만들어 비교하는 것이 오히려 번거롭다는 생각이 들 수 있는데 그럼에도 불구하고 Virtual DOM을 쓰는 이유에 대해 생각해보자.

리액트가 DOM보다 빨라서 사용한다는 미신이 있기도 하지만 트위터 제작자 분께서 현실은 이렇다고 말하신다.

> 리액트는 유지보수하기 훨씬 좋기 때문에 사용하는 것이다. 속도도 DOM에 비해 월등이 빠르다기보다는 충분히 빠르다.

그리고 Virtual DOM을 사용하는 이유의 핵심은 **선언적 API를 가능하게 한다**는 것이다.

VDOM이 무엇이고 왜 쓰는지 잘 이해한다면 활용할 수 있는 최적화 기법들이 존재한다고 한다. (아직은 잘 와닿지 않기에 아래 문서를 차차 이해해보기)

[성능 최적화](https://ko.reactjs.org/docs/optimizing-performance.html)

그러니 VDOM에 대해 완벽히 이해하고 넘어가자!

## Strict Mode

StrictMode는 개발 모드에서만 활성화되고 빌드에는 영향을 미치지 않는다.

코드를 짜는 동안 애플리케이션의 잠재적인 문제를 알아내기 위한 도구이다.

개발자 도구의 Component 탭에서 Strict Mode를 사용하지 않으면 경고 표시가 뜬다.

```javascript
root.render(
  <React.StrictMode>
    <App />
  </React.StrictMode>
);
```

위처럼 StrictMode로 감싸주면 경고가 사라지게 된다.

+) StrictMode 관련 공식 문서를 읽어봤지만 아직 경험부족으로 내용을 이해하기가 힘들었다. 나중에 꼭 리액트 공식 문서 내용을 이해하고 정리해야겠다.

[Strict모드](https://ko.reactjs.org/docs/strict-mode.html)
